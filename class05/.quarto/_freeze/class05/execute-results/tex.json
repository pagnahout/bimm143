{
  "hash": "2aad37935ab39f4e7faa912c412413da",
  "result": {
    "markdown": "---\ntitle: \"Class 05: Data Visualization with ggplot2\"\nauthor: Pagna Hout\ndate: 2023-04-19\nformat: pdf\neditor_options: \n  chunk_output_type: inline\n---\n\n\nLoad package\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nggplot(cars)\n```\n\n::: {.cell-output-display}\n![](class05_files/figure-pdf/unnamed-chunk-1-1.pdf){fig-pos='H'}\n:::\n:::\n\n\nSpecifying aesthetic mappings with aes ()\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(cars) +\n  aes (x=speed, y=dist)\n```\n\n::: {.cell-output-display}\n![](class05_files/figure-pdf/unnamed-chunk-2-1.pdf){fig-pos='H'}\n:::\n:::\n\n\nSpecifying a geom layer with geom_point()\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(cars) +\n  aes (x=speed, y=dist) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](class05_files/figure-pdf/unnamed-chunk-3-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n### Adding trend line layer to help show the relationship between the plot variables with the geom_smooth() function\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(cars) +\n  aes (x=speed, y=dist) +\n  geom_point() +\n  geom_smooth()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](class05_files/figure-pdf/unnamed-chunk-4-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n### Adding straight line from linear model without the shaded standard error region\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(cars) +\n  aes(x=speed, y=dist) +\n  geom_point() +\n  geom_smooth(method=\"lm\", se=FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](class05_files/figure-pdf/unnamed-chunk-5-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n### Adding various label annotations with the labs() function and changing the plot to look more conservative \"black & white\" theme by adding the theme.bw() function\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(cars) + \n  aes(x=speed, y=dist) +\n  geom_point() +\n  labs(title=\"Speed and Stopping Distances of Cars\",\n       x=\"Speed (MPH)\", \n       y=\"Stopping Distance (ft)\",\n       subtitle = \"Your informative subtitle text here\",\n       caption=\"Dataset: 'cars'\") +\n  geom_smooth(method=\"lm\", se=FALSE) +\n  theme_bw()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](class05_files/figure-pdf/unnamed-chunk-6-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n### Adding more plot aesthetics through aes()\n\n\n::: {.cell}\n\n```{.r .cell-code}\nurl <- \"https://bioboot.github.io/bimm143_S20/class-material/up_down_expression.txt\"\ngenes <- read.delim(url)\nhead(genes)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        Gene Condition1 Condition2      State\n1      A4GNT -3.6808610 -3.4401355 unchanging\n2       AAAS  4.5479580  4.3864126 unchanging\n3      AASDH  3.7190695  3.4787276 unchanging\n4       AATF  5.0784720  5.0151916 unchanging\n5       AATK  0.4711421  0.5598642 unchanging\n6 AB015752.4 -3.6808610 -3.5921390 unchanging\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnrow(genes)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 5196\n```\n:::\n\n```{.r .cell-code}\nncol(genes)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 4\n```\n:::\n\n```{.r .cell-code}\ncolnames(genes)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Gene\"       \"Condition1\" \"Condition2\" \"State\"     \n```\n:::\n\n```{.r .cell-code}\ntable(genes$State)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n      down unchanging         up \n        72       4997        127 \n```\n:::\n\n```{.r .cell-code}\nround (table(genes$State)/nrow(genes)*100,2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n      down unchanging         up \n      1.39      96.17       2.44 \n```\n:::\n:::\n\n\nFirst basic scatter plot of the dataset:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(genes) + \n    aes(x=Condition1, y=Condition2) +\n    geom_point()\n```\n\n::: {.cell-output-display}\n![](class05_files/figure-pdf/unnamed-chunk-9-1.pdf){fig-pos='H'}\n:::\n:::\n\n\nThere is extra information in this dataset, namely the `State` column, which tells us whether the difference in expression values between conditions is statistically significant. Let's map this column to point color:\n\n\n::: {.cell}\n\n```{.r .cell-code}\np <- ggplot(genes) + \n    aes(x=Condition1, y=Condition2, col=State) +\n    geom_point()\np\n```\n\n::: {.cell-output-display}\n![](class05_files/figure-pdf/unnamed-chunk-10-1.pdf){fig-pos='H'}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\np + scale_colour_manual( values=c(\"blue\",\"gray\",\"red\") )\n```\n\n::: {.cell-output-display}\n![](class05_files/figure-pdf/unnamed-chunk-11-1.pdf){fig-pos='H'}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\np + scale_colour_manual(values=c(\"blue\",\"gray\",\"red\")) +\n    labs(title=\"Gene Expresion Changes Upon Drug Treatment\",\n         x=\"Control (no drug) \",\n         y=\"Drug Treatment\")\n```\n\n::: {.cell-output-display}\n![](class05_files/figure-pdf/unnamed-chunk-12-1.pdf){fig-pos='H'}\n:::\n:::\n",
    "supporting": [
      "class05_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}